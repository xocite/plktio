{"componentChunkName":"component---src-templates-blog-template-js","path":"/writing/upgrading-to-debian-stretch","webpackCompilationHash":"18dcba35927ce9e18614","result":{"data":{"markdownRemark":{"html":"<p>Debian 10: Buster was released on July.  Let's upgrade to the latest version.</p>\n<p>Check your current version with: <code class=\"language-text\">hostnamectl</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ hostnamectl\n   Static hostname: baytrail\n         Icon name: computer-desktop\n           Chassis: desktop\n        Machine ID: 6535c38e46164760b537c1f1f792c734\n           Boot ID: b53c54cceb0b473e8fec1243e0929c68\n  Operating System: Debian GNU/Linux 9 (stretch)\n            Kernel: Linux 4.9.0-8-amd64\n      Architecture: x86-64</code></pre></div>\n<p>Next, decide how you're going to back up the system.  I opted for LVM snapshots\nbut unfortunately I didn't have enough space.  I resized my home logical volume\nto create more space.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ lvs\n  LV          VG          Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\n  home        baytrail-vg -wi-ao----  33.56g                                                    \n  root        baytrail-vg -wi-ao----  17.71g                                                    \n  swap_1      baytrail-vg -wi-ao----   3.89g                                                    </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># lsof /home\n\n# umount /home\n\n# e2fsck -f /dev/mapper/baytrail--vg-home \ne2fsck 1.43.4 (31-Jan-2017)\nPass 1: Checking inodes, blocks, and sizes\nInode 1177663 extent tree (at level 1) could be narrower.  Fix&lt;y&gt;? yes\n\nPass 1E: Optimizing extent trees\nPass 2: Checking directory structure\nPass 3: Checking directory connectivity\nPass 4: Checking reference counts\nPass 5: Checking group summary information\n\n/dev/mapper/baytrail--vg-home: ***** FILE SYSTEM WAS MODIFIED *****\n/dev/mapper/baytrail--vg-home: 103209/2199344 files (0.8% non-contiguous), 2709830/8797184 blocks\n\n# lvreduce --resizefs -L 27G /dev/mapper/baytrail--vg-home \nfsck from util-linux 2.29.2\n/dev/mapper/baytrail--vg-home: clean, 103209/2199344 files, 2709830/8797184 blocks\nresize2fs 1.43.4 (31-Jan-2017)\nResizing the filesystem on /dev/mapper/baytrail--vg-home to 7077888 (4k) blocks.\nThe filesystem on /dev/mapper/baytrail--vg-home is now 7077888 (4k) blocks long.\n\n  Size of logical volume baytrail-vg/home changed from 33.56 GiB (8591 extents) to 27.00 GiB (6912 extents).\n  Logical volume baytrail-vg/home successfully resized.\n\n# mount /home\n\n# lvcreate -L 5G -s -n stretch-backup /dev/mapper/baytrail--vg-root \n  Using default stripesize 64.00 KiB.\n  Logical volume &quot;stretch-backup&quot; created.</code></pre></div>\n<p>Now we can start installing Debian Buster.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># apt update\n# apt upgrade\n# apt dist-upgrade</code></pre></div>\n<p>Check for any errors.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># dpkg -C\n# apt-mark showhold</code></pre></div>\n<p>Update your package repositories by changing all occurences of <code class=\"language-text\">stretch</code> to\n<code class=\"language-text\">buster</code> in <code class=\"language-text\">/etc/apt/sources.list</code>.</p>\n<p>Finally, run the apt update/upgrade/dist-upgrade commands again and you should\nbe all set.</p>\n<p>Reboot and test the new system.  If there are no errors, you can remove the\nsnapshot.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># lvremove /dev/mapper/baytrail--vg-stretch--backup</code></pre></div>","frontmatter":{"date":"2019-08-16","updated":null,"path":"/writing/upgrading-to-debian-stretch","title":"Upgrading to Debian 10 Buster from Debian 9 Stretch"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}
{"componentChunkName":"component---src-templates-blog-template-js","path":"/writing/installing-vscode-open","result":{"data":{"markdownRemark":{"html":"<p>VSCode is pretty good multi-platform editor made by Microsoft that's available as a <a href=\"https://snapcraft.io/vscode\">snap</a>.  Unfortunately, this snap is released under Microsoft's standard product EULA along with the builds available on their GitHub.  Fortunately, the source code is available under MIT license.  Here's how I built it.</p>\n<p>The following work served as a great introduction to gulp, a JS build system, and yarn, a JS package manager.</p>\n<p>You can either use LXD or <a href=\"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html\">systemd-nspawn</a> to create a container to build it.  Or you can build it locally if you already have yarn installed but I wanted to separate the two as I move to creating my build server in the near future.</p>\n<p>I pulled a lot of build instructions from the <a href=\"https://github.com/microsoft/vscode/blob/master/build/azure-pipelines/linux/product-build-linux.yml\">Azure Pipelines YAML</a> file Microsoft uses to build the binary.</p>\n<h2>Create and start container using LXD.</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">lxc init images:debian/buster/amd64 vscode\nlxc start vscode\n$ lxc exec vscode -- /bin/bash</code></pre></div>\n<h2>Install the latest yarn</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># apt install gpg curl apt-transport-https lsb-release\n# curl -Ss https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -\n# echo &quot;deb https://dl.yarnpkg.com/debian/ stable main&quot; | tee /etc/apt/sources.list.d/yarn.list\n# apt update &amp;&amp; apt install yarn</code></pre></div>\n<h2>Install the latest Node</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># curl -Ss https://deb.nodesource.com/gpgkey/nodesource.gpg.key | apt-key add -\n# echo &quot;deb https://deb.nodesource.com/node_10.x buster main&quot; | tee -a /etc/apt/sources.list.d/nodesource.list\n# echo &quot;deb-src https://deb.nodesource.com/node_10.x buster main&quot; | tee -a /etc/apt/sources.list.d/nodesource.list\n# apt update &amp;&amp; apt install nodejs</code></pre></div>\n<h2>Install build tools</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># apt install gcc g++ make </code></pre></div>\n<h2>Install VSCode dependencies</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># apt install git make pkg-config fakeroot libx11-dev libxkbfile-dev libsecret-1-dev libgtk-3-0 libasound2 libnotify4</code></pre></div>\n<h2>Clone and build VSCode as a local user</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># adduser vscode\n# su -l vscode\n$ git clone https://github.com/Microsoft/vscode.git \n$ cd vscode/build\n(increase max memory usage for Node) \n$ export NODE_OPTIONS=&quot;--max-old-space-size=4096&quot;\n$ yarn global add typescript gulp-yarn gulp-cli\n$ yarn\n$ yarn postinstall\n$ yarn gulp\n$ yarn gulp compile-build\n$ yarn gulp compile-extensions-build\n$ yarn gulp minify-vscode\n$ yarn gulp vscode-linux-x64-min-ci\n$ yarn gulp vscode-linux-x64-build-deb\n# dpkg -i /home/vscode/vscode/.build/linux/deb/amd64/deb/code-*.deb</code></pre></div>\n<h2>Forward X11 socket to display on container host</h2>\n<p>This is probably the most difficult part as we'll need to present the running program on the local host.  I used a combination of the information available <a href=\"https://github.com/bitsandsalsa/lxd_gui_container\">here</a> and <a href=\"https://blog.simos.info/how-to-run-graphics-accelerated-gui-apps-in-lxd-containers-on-your-ubuntu-desktop/\">here</a> as a guide.</p>\n<h3>Install X11 dependencies in the container</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># apt install xorg xpra ssh</code></pre></div>\n<h3>Install X11 dependencies in the host</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo apt install xpra</code></pre></div>\n<h2>Run VSCode - OSS version from the host</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(get IP address of container from lxc ls)\n$ xpra start ssh:vscode@&lt;ip-address&gt; --start=code-oss</code></pre></div>\n<h2>Success!</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; border-style: solid; max-width: 650px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e4390c3ca5fc1764f1a2dd3f4c35fc1e/a987b/vscode-installation-success.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACSklEQVQoz0WR+04TQRjFt2u7u+1ud9ttO7vbvV9mL922tEAhLaHyp0ptKtGQEB/A0EIwJfgg6gOoUXgfNYJgDXhJvEXRihqIOKDBMyeTbybzy3wzB0ulUtFoNBb7N9XqjVZn7sKl1sXZy525q/ML16/NL6Ci3Zlrta/MtjvxeBw7kyiKHMel0ieD5/l6o3F+ZqbZbE43p6caU9VqtVKpVKujpxqrjddyOYDjERzH0W2YAEBKURJAoAmaJMkgCFyv4Lq+aZqqqsqyjApZVvJ5OZ/PK4rCsiy6MnIqLJfJJvk0neQonMTP4Qi2YEHVbVVREKxpGnSgblqSokmypuu6KEkMw7CnwjI5XswCkctyTDJB074fuNAxdO1MpmUiRtdUSVYM07p95+7D9Y179x88Wt/ABAFkRInNihSZiMVivu/bftGAoaYbmqYiCrV90oOqKrJsGHqpXIYQuq5r2/YJzAOBEQBNM0SMcF1oFsY0r/K3ZwTbjm2aBmKR0BLkAEWSFEXh6M0gD1J8juN4hqLRVjEsudCFNnQsx9AMUzc96Dk2RAWybTkoHXQMBUYQBMYl2USWx9KZCEGhb4SqH6ojnhQiF5RyIJdcIXCAb2U9I+3IrI5i+p/zRGOyWqsXahPl0fFycSQslsKwVCyWPS+YnKyv9tduLC7fXL3VR+6vraz0e0vL3d7SYrfX7S5hT7Z2Nrd3XwzePH62M9h7u/3y1dOtwe7rd5uD3eeDveGPo/efh5/2D74eHP46OkY+/H388dvhhy/f94c//wD8zYuKReGscQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vscode installation success\"\n        title=\"vscode installation success\"\n        src=\"/static/e4390c3ca5fc1764f1a2dd3f4c35fc1e/dbb61/vscode-installation-success.png\"\n        srcset=\"/static/e4390c3ca5fc1764f1a2dd3f4c35fc1e/19bd1/vscode-installation-success.png 163w,\n/static/e4390c3ca5fc1764f1a2dd3f4c35fc1e/d3bcb/vscode-installation-success.png 325w,\n/static/e4390c3ca5fc1764f1a2dd3f4c35fc1e/dbb61/vscode-installation-success.png 650w,\n/static/e4390c3ca5fc1764f1a2dd3f4c35fc1e/6b691/vscode-installation-success.png 975w,\n/static/e4390c3ca5fc1764f1a2dd3f4c35fc1e/91670/vscode-installation-success.png 1300w,\n/static/e4390c3ca5fc1764f1a2dd3f4c35fc1e/a987b/vscode-installation-success.png 1920w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>If you'd rather not follow through with these instructions, you can also install a prebuilt OSS version at <a href=\"https://vscodium.com/\">VSCodium</a>.</p>\n<h3>Addendum: gpg keys</h3>\n<p>For posterity's sake I'm including the GPG signatures so you can verify that you've imported the right ones.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## YARN\n$ curl -Ss https://dl.yarnpkg.com/debian/pubkey.gpg | gpg --show-keys\npub   rsa4096 2016-10-05 [SC]\n      72ECF46A56B4AD39C907BBB71646B01B86E50310\nuid                      Yarn Packaging &lt;yarn@dan.cx&gt;\nsub   rsa4096 2016-10-05 [E]\nsub   rsa4096 2016-10-05 [S] [expired: 2017-10-05]\nsub   rsa4096 2016-10-30 [S] [expired: 2019-01-01]\nsub   rsa4096 2017-09-10 [S] [expired: 2019-01-01]\nsub   rsa4096 2019-01-02 [S] [expires: 2020-02-02]\nsub   rsa4096 2019-01-11 [S] [expires: 2020-02-02]\n\n---\n## NODESOURCE (NODEJS)\n$ curl -Ss https://deb.nodesource.com/gpgkey/nodesource.gpg.key | gpg --show-keys\npub   rsa4096 2014-06-13 [SC]\n      9FD3B784BC1C6FC31A8A0A1C1655A0AB68576280\nuid                      NodeSource &lt;gpg@nodesource.com&gt;\nsub   rsa4096 2014-06-13 [E]</code></pre></div>","frontmatter":{"date":"2019-10-20","updated":null,"path":"/writing/installing-vscode-open","title":"Installing VSCode Open Source Edition"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}